<!DOCTYPE html>
<html lang="de">
  <head>
    <% include ../include/commonHead %>
  </head>
  <body>
    <div class="container">
      <div class="jumbotron" style="background-image: url(/deco/tutorials.png);background-position: right top;background-repeat:no-repeat"><!--<h1>Tutorials</h1><p>Lerne, wie man mit den Ameisen umgeht.</p>-->
	    </div>
	    
	    <% include menu %>
	    
	    <!-- Here comes the content -->
	    
	    <% if (id < 0) { %>
      
        <div class="page-header">
          <h3>Verfügbare Tutorials</h3>
        </div>
        
        <div class="row">
          <div class="col-md-2"></div>
          <div class="col-md-8">
            <ul class="list-group">
            <% for (var i = 1; i <= user.level; i++) { %>
              <% for (var j = 0; j < index[i].length; j++) { %>
                <li class="list-group-item">
                  <% if (done.indexOf(parseInt(index[i][j])) < 0) { %>
                    <span class="badge" style="background-color:#9954bb">neu</span>
                  <% } %>
                  <a href="/tutorial?id=<%=index[i][j]%>"><%=tuts[index[i][j]].name%></a>
                </li>
              <% } %>
            <% } %>
            </ul>
          </div>
          <div class="col-md-2"></div>
        </div>
	    
	    <% } else { %>
	    
	      <% var t = tuts[id] %>
        
        <div class="row">
          <div class="col-md-2"></div>
          <div class="col-md-8">
	          <div class="page-header">
              <h3><%=t.name%></h3>
            </div>
            <%-t.text%>
            <% if (!t.noq) { %>
              <hr>
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h3 class="panel-title">Quiz</h3>
                </div>
                <div class="panel-body">
                  <% for (var i = 0; i < t.questions.length; i++) { %>
                    <div class="checkbox">
                      <label>
                        <input type="checkbox" id="question<%=i%>"> <%=t.questions[i]%>
                      </label>
                    </div>
                  <% } %>
                  <button class="btn btn-info btn-sm" onclick="submit()">Überprüfen</button>
                </div>
              </div>
              <script>
                function submit() {
                  var request = new XMLHttpRequest();
                  var answer = []
                  for (var i = 0; i < <%=t.questions.length%>; i++) {
                    answer.push(document.getElementById("question" + i).checked)
                  }
                  var link = "/tutorialcheck?data=" + JSON.stringify(answer) + "&id=<%=id%>"
                  request.open("GET", link);
                  request.addEventListener('load', function(event) {
                     if (request.status >= 200 && request.status < 300) {
                        if (request.responseText == "ok") {
                          alert("Glückwunsch, die Antwort ist richtig!")
                          window.location = "/tutorial"
                        } else {
                          alert("Die Antwort ist falsch.")
                        }
                     }
                  });
                  request.send();
                }           
              </script>
            <% } %>
          </div>
          <div class="col-md-2"></div>
        </div>
        
	    
	    <% } %>    
	    
	    
      <div style="height:300px"></div>
	    
    </div>
  </body>
</html>
